<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Check</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 50px; }
        h1 { color: #333; }
        .loading { font-size: 18px; color: gray; }
    </style>
</head>
<body>
    <h1>Checking Your Internet Speed...</h1>
    <p class="loading">Please wait a few seconds.</p>

    <script>
        async function checkSpeed() {
            const testUrl = "https://speed.hetzner.de/10MB.bin"; // 10MB test file for better accuracy
            const fileSize = 10 * 8; // 10MB in Megabits (1MB = 8 Megabits)

            const startTime = performance.now();
            try {
                const response = await fetch(testUrl, { method: "GET", cache: "no-cache" });
                if (!response.ok) throw new Error("Failed to download test file.");
                await response.blob(); // Ensure file is fully downloaded
                const endTime = performance.now();

                const duration = (endTime - startTime) / 1000; // Time in seconds
                const speedMbps = (fileSize / duration).toFixed(2); // Mbps calculation

                if (speedMbps < 100) {
                    document.body.innerHTML = `<h1>Insufficient Speed!</h1><p>Your speed: ${speedMbps} Mbps (100 Mbps required)</p>`;
                } else {
                    document.body.innerHTML = `<h1>Success! You have sufficient speed.</h1><p>Your speed: ${speedMbps} Mbps</p>`;
                }
            } catch (error) {
                document.body.innerHTML = `<h1>Error!</h1><p>Could not test speed. Please try again.</p>`;
            }
        }

        checkSpeed();
    </script>
</body>
</html>
